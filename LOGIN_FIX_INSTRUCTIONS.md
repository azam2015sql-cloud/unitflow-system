# حل مشكلة تسجيل الدخول

## 🔍 المشكلة
- المستخدم `admin` بكلمة المرور `admin123` لا يعمل
- المستخدم `azam` بكلمة المرور `azam123` لا يعمل  
- المستخدم `sufyan` بكلمة المرور `suf123` يعمل فقط

## 🛠️ الحل

### الخطوة 1: تشغيل الخادم
```bash
cd backend
npm start
```

### الخطوة 2: فتح صفحة الفحص
افتح المتصفح واذهب إلى:
```
http://localhost:3000/frontend/debug.html
```

### الخطوة 3: فحص المستخدمين الحاليين
1. اضغط على زر "تحميل المستخدمين"
2. ستظهر قائمة بجميع المستخدمين في قاعدة البيانات
3. لاحظ كلمات المرور المخزنة

### الخطوة 4: إعادة تعيين كلمات المرور
1. اضغط على زر "إعادة تعيين كلمات المرور"
2. سيتم إنشاء/تحديث المستخدمين التاليين:
   - **admin** / **admin123** (مدير النظام) → `admin.html`
   - **azam** / **azam123** (موظف العمليات) → `operations.html`
   - **sufyan** / **suf123** (موظف القسم الفني) → `technical.html`

### الخطوة 5: اختبار تسجيل الدخول
1. اذهب إلى صفحة تسجيل الدخول: `http://localhost:3000/frontend/index.html`
2. جرب تسجيل الدخول بالمستخدمين:
   - `admin` / `admin123`
   - `azam` / `azam123`
   - `sufyan` / `suf123`

## 🔧 التحسينات المطبقة

### 1. نظام تسجيل الدخول المحسن
- يدعم كلمات المرور العادية (غير مشفرة)
- يدعم كلمات المرور المشفرة بـ bcrypt
- رسائل خطأ واضحة في وحدة التحكم

### 2. مسارات التطوير
- `/api/debug/users` - فحص المستخدمين
- `/api/debug/reset-passwords` - إعادة تعيين كلمات المرور

### 3. صفحة الفحص
- `frontend/debug.html` - واجهة لفحص وإدارة المستخدمين

## 📋 المستخدمون الجدد

| اسم المستخدم | كلمة المرور | القسم | صفحة العمل |
|-------------|------------|-------|------------|
| admin | admin123 | management | admin.html |
| azam | azam123 | operations | operations.html |
| sufyan | suf123 | technical | technical.html |

## 🎯 التوجيه حسب الدور

### مدير النظام (admin)
- يتم توجيهه إلى `admin.html`
- يمكنه الوصول لجميع الصفحات
- يرى جميع الوحدات

### موظف العمليات (azam)
- يتم توجيهه إلى `operations.html`
- يمكنه الوصول لصفحة العمليات فقط
- يرى وحدات العمليات فقط

### موظف القسم الفني (sufyan)
- يتم توجيهه إلى `technical.html`
- يمكنه الوصول لصفحة القسم الفني فقط
- يرى وحدات القسم الفني فقط

## 🚨 ملاحظات مهمة

1. **أمان التطوير**: مسارات `/api/debug/*` مخصصة للتطوير فقط ويجب إزالتها في الإنتاج
2. **كلمات المرور**: حالياً غير مشفرة للتسهيل، يجب تشفيرها في الإنتاج
3. **قاعدة البيانات**: تأكد من أن قاعدة البيانات `unitflow_db1` تعمل بشكل صحيح

## 🔄 إعادة تشغيل النظام

إذا لم تعمل الحلول السابقة:

1. أوقف الخادم (Ctrl+C)
2. أعد تشغيله:
   ```bash
   cd backend
   npm start
   ```
3. امسح cache المتصفح (Ctrl+F5)
4. جرب تسجيل الدخول مرة أخرى

## 📞 الدعم

إذا استمرت المشكلة:
1. تحقق من رسائل الخطأ في وحدة التحكم (F12)
2. تحقق من رسائل الخادم في Terminal
3. تأكد من اتصال قاعدة البيانات
